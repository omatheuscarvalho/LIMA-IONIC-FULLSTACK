<svg width="1200" height="800" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 24px; font-weight: bold; fill: #2c3e50; }
      .subtitle { font-family: Arial, sans-serif; font-size: 16px; font-weight: bold; fill: #34495e; }
      .text { font-family: Arial, sans-serif; font-size: 12px; fill: #2c3e50; }
      .small-text { font-family: Arial, sans-serif; font-size: 10px; fill: #7f8c8d; }
      .service-box { fill: #3498db; stroke: #2980b9; stroke-width: 2; }
      .guard-box { fill: #e74c3c; stroke: #c0392b; stroke-width: 2; }
      .page-box { fill: #2ecc71; stroke: #27ae60; stroke-width: 2; }
      .route-box { fill: #f39c12; stroke: #e67e22; stroke-width: 2; }
      .storage-box { fill: #9b59b6; stroke: #8e44ad; stroke-width: 2; }
      .arrow { stroke: #34495e; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .flow-arrow { stroke: #e74c3c; stroke-width: 3; fill: none; marker-end: url(#flowhead); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#34495e" />
    </marker>
    <marker id="flowhead" markerWidth="12" markerHeight="8" refX="11" refY="4" orient="auto">
      <polygon points="0 0, 12 4, 0 8" fill="#e74c3c" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="600" y="30" text-anchor="middle" class="title">Arquitetura de Autenticação - LIMA</text>
  
  <!-- AuthService -->
  <rect x="50" y="80" width="200" height="120" rx="10" class="service-box"/>
  <text x="150" y="105" text-anchor="middle" class="subtitle" fill="white">AuthService</text>
  <text x="60" y="125" class="text" fill="white">• login()</text>
  <text x="60" y="140" class="text" fill="white">• register()</text>
  <text x="60" y="155" class="text" fill="white">• logout()</text>
  <text x="60" y="170" class="text" fill="white">• isAuthenticated()</text>
  <text x="60" y="185" class="text" fill="white">• getCurrentUser()</text>
  
  <!-- Guards -->
  <rect x="320" y="80" width="150" height="80" rx="10" class="guard-box"/>
  <text x="395" y="105" text-anchor="middle" class="subtitle" fill="white">AuthGuard</text>
  <text x="330" y="125" class="text" fill="white">• canActivate()</text>
  <text x="330" y="140" class="text" fill="white">• Protege rotas</text>
  
  <rect x="320" y="180" width="150" height="80" rx="10" class="guard-box"/>
  <text x="395" y="205" text-anchor="middle" class="subtitle" fill="white">NoAuthGuard</text>
  <text x="330" y="225" class="text" fill="white">• canActivate()</text>
  <text x="330" y="240" class="text" fill="white">• Redireciona logados</text>
  
  <!-- Pages -->
  <rect x="550" y="60" width="120" height="60" rx="10" class="page-box"/>
  <text x="610" y="85" text-anchor="middle" class="subtitle" fill="white">Login Page</text>
  <text x="560" y="105" class="text" fill="white">• Formulário</text>
  
  <rect x="550" y="140" width="120" height="60" rx="10" class="page-box"/>
  <text x="610" y="165" text-anchor="middle" class="subtitle" fill="white">Register Page</text>
  <text x="560" y="185" class="text" fill="white">• Validações</text>
  
  <rect x="550" y="220" width="120" height="60" rx="10" class="page-box"/>
  <text x="610" y="245" text-anchor="middle" class="subtitle" fill="white">Home Page</text>
  <text x="560" y="265" class="text" fill="white">• App principal</text>
  
  <!-- Routes -->
  <rect x="750" y="80" width="150" height="120" rx="10" class="route-box"/>
  <text x="825" y="105" text-anchor="middle" class="subtitle" fill="white">App Routes</text>
  <text x="760" y="125" class="text" fill="white">• /login (NoAuthGuard)</text>
  <text x="760" y="140" class="text" fill="white">• /register (NoAuthGuard)</text>
  <text x="760" y="155" class="text" fill="white">• /home (AuthGuard)</text>
  <text x="760" y="170" class="text" fill="white">• /history (AuthGuard)</text>
  <text x="760" y="185" class="text" fill="white">• /help (AuthGuard)</text>
  
  <!-- Storage -->
  <rect x="50" y="250" width="200" height="80" rx="10" class="storage-box"/>
  <text x="150" y="275" text-anchor="middle" class="subtitle" fill="white">localStorage</text>
  <text x="60" y="295" class="text" fill="white">• JWT Token</text>
  <text x="60" y="310" class="text" fill="white">• Persistência de sessão</text>
  
  <!-- App Component -->
  <rect x="320" y="350" width="200" height="80" rx="10" class="service-box"/>
  <text x="420" y="375" text-anchor="middle" class="subtitle" fill="white">App Component</text>
  <text x="330" y="395" class="text" fill="white">• Inicialização</text>
  <text x="330" y="410" class="text" fill="white">• Verificação de auth</text>
  
  <!-- Flow Description -->
  <rect x="950" y="80" width="220" height="300" rx="10" fill="#ecf0f1" stroke="#bdc3c7" stroke-width="2"/>
  <text x="1060" y="105" text-anchor="middle" class="subtitle">Fluxo de Autenticação</text>
  
  <text x="960" y="130" class="text">1. Usuário acessa aplicação</text>
  <text x="960" y="150" class="text">2. App Component verifica token</text>
  <text x="960" y="170" class="text">3. Se não autenticado → Login</text>
  <text x="960" y="190" class="text">4. Login/Register → AuthService</text>
  <text x="960" y="210" class="text">5. Token salvo no localStorage</text>
  <text x="960" y="230" class="text">6. Guards verificam acesso</text>
  <text x="960" y="250" class="text">7. Redirecionamento automático</text>
  <text x="960" y="270" class="text">8. Logout limpa token</text>
  
  <text x="960" y="300" class="small-text">JWT: JSON Web Token</text>
  <text x="960" y="315" class="small-text">Guards: Proteção de rotas</text>
  <text x="960" y="330" class="small-text">localStorage: Armazenamento local</text>
  <text x="960" y="345" class="small-text">Observable: Programação reativa</text>
  
  <!-- Arrows -->
  <!-- AuthService to Guards -->
  <line x1="250" y1="120" x2="320" y2="120" class="arrow"/>
  <line x1="250" y1="140" x2="320" y2="220" class="arrow"/>
  
  <!-- Guards to Pages -->
  <line x1="470" y1="90" x2="550" y2="90" class="arrow"/>
  <line x1="470" y1="120" x2="550" y2="170" class="arrow"/>
  <line x1="470" y1="220" x2="550" y2="250" class="arrow"/>
  
  <!-- Pages to Routes -->
  <line x1="670" y1="90" x2="750" y2="120" class="arrow"/>
  <line x1="670" y1="170" x2="750" y2="140" class="arrow"/>
  <line x1="670" y1="250" x2="750" y2="160" class="arrow"/>
  
  <!-- AuthService to Storage -->
  <line x1="150" y1="200" x2="150" y2="250" class="arrow"/>
  
  <!-- App Component to AuthService -->
  <line x1="320" y1="380" x2="250" y2="160" class="arrow"/>
  
  <!-- Flow arrows -->
  <path d="M 960 130 Q 900 100 825 100" class="flow-arrow"/>
  <text x="880" y="95" class="small-text">Inicialização</text>
  
  <path d="M 960 190 Q 850 180 670 90" class="flow-arrow"/>
  <text x="800" y="140" class="small-text">Login</text>
  
  <path d="M 960 210 Q 800 240 250 290" class="flow-arrow"/>
  <text x="600" y="260" class="small-text">Armazenamento</text>
  
  <!-- Legend -->
  <rect x="50" y="500" width="1100" height="250" rx="10" fill="#f8f9fa" stroke="#dee2e6" stroke-width="2"/>
  <text x="600" y="525" text-anchor="middle" class="subtitle">Componentes e Responsabilidades</text>
  
  <!-- Legend items -->
  <rect x="80" y="550" width="20" height="15" class="service-box"/>
  <text x="110" y="562" class="text">AuthService: Gerencia autenticação, tokens JWT e estado do usuário</text>
  
  <rect x="80" y="580" width="20" height="15" class="guard-box"/>
  <text x="110" y="592" class="text">Guards: Protegem rotas baseado no estado de autenticação</text>
  
  <rect x="80" y="610" width="20" height="15" class="page-box"/>
  <text x="110" y="622" class="text">Pages: Interfaces de usuário (Login, Register, Home)</text>
  
  <rect x="80" y="640" width="20" height="15" class="route-box"/>
  <text x="110" y="652" class="text">Routes: Configuração de navegação e proteção de rotas</text>
  
  <rect x="80" y="670" width="20" height="15" class="storage-box"/>
  <text x="110" y="682" class="text">localStorage: Armazenamento persistente do token JWT</text>
  
  <text x="80" y="710" class="text">Características principais:</text>
  <text x="80" y="725" class="small-text">• Autenticação baseada em JWT (JSON Web Tokens)</text>
  <text x="80" y="740" class="small-text">• Persistência de sessão via localStorage</text>
  <text x="350" y="725" class="small-text">• Guards para proteção automática de rotas</text>
  <text x="350" y="740" class="small-text">• Redirecionamento inteligente baseado no estado</text>
  <text x="650" y="725" class="small-text">• Validações client-side robustas</text>
  <text x="650" y="740" class="small-text">• Interface responsiva com Ionic</text>
</svg>